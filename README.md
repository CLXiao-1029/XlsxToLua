# XlsxToLua

一款将Excel数据转换成lua表的工具，支持分表和总表导出，支持多语言。

# 支持库版本

| 支持库       | 版本    | 地址                                                     |
|-----------|-------|--------------------------------------------------------|
| EPPlus    | 7.3.1 | https://epplussoftware.com/                            |
| .Net Core | 7.x   | https://dotnet.microsoft.com/en-us/download/dotnet/7.0 |

# 使用方法

文件夹`Example`下存放着总表和分表的示例，可以参考。

文件`配置表模板演示.xlsx`中有支持的数据类型说明。

### xlsx表头模板说明

> 第一行：字段描述（可空）
>
>第二行：字段名字（值为空时，第三行的字段类型无效）
>
>第三行：字段类型（值为空或无效时不导出当前列）不区分大小写
>
>第四行：标识当前列是否加入多语言翻译总表进行翻译（可空）。需要翻译当前列时，填true，其他情况不填或false（不区分大小写）
>
>第五行：空占位

### xlsx工作簿名字格式

> 每张需要进行导出的表，命名规则需要以竖线（“|”）进行分割。示例：物品表|Items，Items作为Lua表的表名，前面的描述用来配表人员查看和区分。

### 多语言翻译表

> 第一个工作簿为多语言内容区域
>
> 第一行：多语言的语种名字
>
> 第二行：多语言的语种简写，也是导出的lua多语言表的名字。比如 zh.lua
>
> 第三行：空占位
>
> 第一列：多语言的键，也是在游戏中读取lua多语言表的键。

### 配置表数据类型

| 名字  | 类型                               | 示例                          | 释义                                                  |
|-----|----------------------------------|-----------------------------|-----------------------------------------------------|
| 数值  | `int`, `float`, `double`, `long` | `1`,`1.2`                   | int，float                                           |
| 文本  | `string`                         | `游戏开始`                      | string                                              |
| 布尔  | `bool`, `boolean`                | `false`                     | bool                                                |
| 表   | `table`                          | `{id=1,count=100}`          | table                                               |
| 数组  | `array`,`[]`                     | `1\|2`,`游戏\|开始`             | array[int]，string[]                            |
| 数组表 | `arrayTable[xxx]`,`{xxx}[]`      | `1,100\|2,100`,`1,游戏\|2,开始` | arrayTable[id:int,count:int]，{id:int,info:string}[] |

> 数字：`int`, `float`, `double`, `long`
>
> 字符串：`string`
>
> 布尔：`bool`, `boolean`
>
> 表：`table`
>
> 数组：`array`，`[]`
>
> 数组表：`arrayTable[xxx]`，`{xxx}[]`
>
> 任意值：`any`。
> 
具体示例请查看`Example`文件夹的文件`配置表模板演示.xlsx`。

**注意：数据类型不区分大小写**

### 导出配置表说明

打开编辑文件`开始导表XlsxToLua.bat`，可以查看程序的传参。

#### 特殊文件说明

`i18n.lua` 导出的多语言表入口

`zh.lua xx.lua` 多语言对应的语种表

`ConfigComment.lua` 注解拆分后的lua文件

#### 参数说明

| 索引 | 默认值  | 描述           | 释义                                                      |
|----|------|--------------|---------------------------------------------------------|
| 1  |      | 设置Excel文件的路径 |
| 2  |      | 导出Lua文件的路径   |
| 3  | true | 是否为有序数据表     | false:无序数据表(配置表的ID作为索引) true:有序数据表                      |
| 4  | true | 是否生成总配置表     | 设置Excel文件路径下的子文件夹作为文件名导出，可查看例子中的总表模式                    |
| 5  | true | 是否拆分配表注解     | 拆分后会生成 ConfigComment.lua 文件                             |
| 6  | true | 多语言文本提取      |
| 7  | true | 显示时间流逝       |
| 8  | 0    | 获取文件夹的提交记录   | 0:默认不获取 1:获取Git 2:获取SVN                                 |
| 9  | 0    | 导出名字规则       | 总表模式有效 0:默认 1:首字母大写 2:首字母小写 3:转大写 4:转小写 5:大驼峰命名 6:小驼峰命名 |

#### 运行命令
>".\XlsxToLua.exe" ./Config ./Lua false false true true true 0 0




---
最后编辑于2024年9月10日
